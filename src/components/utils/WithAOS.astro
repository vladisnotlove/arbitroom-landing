---
import { parse, HTMLElement } from "node-html-parser";
import "aos/dist/aos.css";

interface Props {
    animation:
        | "fade"
        | "fade-up"
        | "fade-down"
        | "fade-left"
        | "fade-right"
        | "fade-up-right"
        | "fade-up-left"
        | "fade-down-right"
        | "fade-down-left"
        | "flip-up"
        | "flip-down"
        | "flip-left"
        | "flip-right"
        | "slide-up"
        | "slide-down"
        | "slide-left"
        | "slide-right"
        | "zoom-in"
        | "zoom-in-up"
        | "zoom-in-down"
        | "zoom-in-left"
        | "zoom-in-right"
        | "zoom-out"
        | "zoom-out-up"
        | "zoom-out-down"
        | "zoom-out-left"
        | "zoom-out-right";
    offset?: number;
    duration?: number;
    easing?:
        | "linear"
        | "ease"
        | "ease-in"
        | "ease-out"
        | "ease-in-out"
        | "ease-in-back"
        | "ease-out-back"
        | "ease-in-out-back"
        | "ease-in-sine"
        | "ease-out-sine"
        | "ease-in-out-sine"
        | "ease-in-quad"
        | "ease-out-quad"
        | "ease-in-out-quad"
        | "ease-in-cubic"
        | "ease-out-cubic"
        | "ease-in-out-cubic"
        | "ease-in-quart"
        | "ease-out-quart"
        | "ease-in-out-quart";
    delay?: number;
    anchor?: string;
    anchorPlacement?:
        | "top-bottom"
        | "top-center"
        | "top-top"
        | "center-bottom"
        | "center-center"
        | "center-top"
        | "bottom-bottom"
        | "bottom-center"
        | "bottom-top";
    once?: boolean;
}

const {
    animation,
    offset,
    duration,
    easing,
    delay,
    anchor,
    anchorPlacement,
    once,
} = Astro.props;

const html = await Astro.slots.render("default");
const dom = parse(html);

dom.childNodes.forEach((node) => {
    // ELEMENT
    if (node instanceof HTMLElement) {
        node.setAttribute("data-js", "");
        node.setAttribute("data-aos", animation);
        if (offset) node.setAttribute("data-aos-offset", "" + offset);
        if (duration) node.setAttribute("data-aos-duration", "" + duration);
        if (easing) node.setAttribute("data-aos-easing", easing);
        if (delay) node.setAttribute("data-aos-delay", "" + delay);
        if (anchor) node.setAttribute("data-aos-anchor", "" + anchor);
        if (anchorPlacement)
            node.setAttribute("data-aos-anchorPlacement", "" + anchorPlacement);
        if (once) node.setAttribute("data-aos-once", "" + once);
    }
});
---

<Fragment set:html={dom.toString()} />

<script>
    import AOS from "aos";

    AOS.init();
</script>
